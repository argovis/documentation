

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Adding a new dataset &mdash; argovis  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> argovis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Argovis data schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/qsp.html">API Query String Parameters</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">argovis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Adding a new dataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/database/adding_new_data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adding-a-new-dataset">
<span id="adding-new-data"></span><h1>Adding a new dataset<a class="headerlink" href="#adding-a-new-dataset" title="Permalink to this headline">¶</a></h1>
<p>In order to add a new data product to Argovis, there are several planning and prepatory steps outlined in this document.</p>
<div class="section" id="schema-development">
<h2>Schema development<a class="headerlink" href="#schema-development" title="Permalink to this headline">¶</a></h2>
<p>Our first step is to plan an appropriate schema for the new data and metadata collections that will be populated by this new dataset. This schema <em>must</em> obey the standards outlined in <a class="reference internal" href="schema.html#schema"><span class="std std-ref">Argovis data schema</span></a>, or otherwise must be marked experimental in the API (see <a class="reference internal" href="../api/adding_new_endpoints.html#adding-new-routes"><span class="std std-ref">Adding new API routes</span></a>, later in the development cycle).</p>
<p>Some considerations at this stage:</p>
<blockquote>
<div><ul>
<li><p>Plan at least one consulting meeting with a subject matter expert on the dataset to discuss how this data is used. Explore topics like:</p>
<ul class="simple">
<li><p>what sort of questions do you commonly ask of this dataset?</p></li>
<li><p>what sort of problems or challenges have you had in the past with this dataset?</p></li>
<li><p>what sort of things would you like to search this dataset for?</p></li>
<li><p>how do you anticipate this dataset changing or growing in the future?</p></li>
</ul>
<p>All these questions may give you ideas on how to organize the data in a way that is useful and familiar to its users, and future proof it for updates.</p>
</li>
<li><p>Where schema rules allow it, change variable names from upstream documents as little as possible to promote familiarity with people already using the upstream data.</p></li>
<li><p>Try to identify a physically meaningful way to divide information between data and metadata documents. For example, Argo metadata documents correspond to information about the float, while data documents each correspond to a single cycle. In general, metadata documents should factor out data that doesn’t change often between temporospatial points, while data documents should capture information unique to a single temporospatial point.</p></li>
<li><p>At the database level, prioritize efficiency: choose arrays of floats rather than bloated dictionaries, for example. Helper functions can be provided to users downstream to help them interpret these documents, but at this level we want documents that are easy to store and fast to transmit.</p></li>
</ul>
</div></blockquote>
<p>Once a plan has been developed and reviewed by a data subject matter expert, add a schema definition script to <a class="reference external" href="https://github.com/argovis/db-schema">https://github.com/argovis/db-schema</a>. Some considerations for this script:</p>
<blockquote>
<div><ul class="simple">
<li><p>Data and metadata collections are typically named <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">xMeta</span></code>, respectively, where <code class="docutils literal notranslate"><span class="pre">x</span></code> is a short but meaningful label for the dataset, like <code class="docutils literal notranslate"><span class="pre">argo</span></code> or <code class="docutils literal notranslate"><span class="pre">cchdo</span></code>. In the case of highly regular classes of data which have very few metadata records, like extended objects and timeseries, metadata documents may be lumped together in collections like <code class="docutils literal notranslate"><span class="pre">timeseriesMeta</span></code> and <code class="docutils literal notranslate"><span class="pre">extendedMeta</span></code>.</p></li>
<li><p>You should have learned in consultation with subject matter experts how they plan on searching this data, which informs the indexes you’ll want to specify in this step. Note that the indexes defined for the data collection in <a class="reference external" href="https://github.com/argovis/db-schema/blob/main/tc.py">https://github.com/argovis/db-schema/blob/main/tc.py</a> are mandatory for all data collections, but more can be added as needed on a case-by-case basis.</p></li>
</ul>
</div></blockquote>
<p>Once complete, run your script and ensure that you have appropriate empty collections with schema and indexes defined in MongoDB.</p>
</div>
<div class="section" id="database-population">
<h2>Database population<a class="headerlink" href="#database-population" title="Permalink to this headline">¶</a></h2>
<p>At this point, it’s time to start populating your new collections. <a class="reference external" href="https://github.com/argovis/tc-sync">https://github.com/argovis/tc-sync</a> provides a complete but relatively simple example of what you need to produce:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://github.com/argovis/tc-sync/blob/main/tcload.py">https://github.com/argovis/tc-sync/blob/main/tcload.py</a> translates upstream data into JSON data and metadata documents, and pushes those to MongoDB. The schema enforcement rules you defined above should guarantee that no malformed documents are pushed to the collection, helping you debug this script.</p></li>
<li><p><a class="reference external" href="https://github.com/argovis/tc-sync/blob/main/summary-computation.py">https://github.com/argovis/tc-sync/blob/main/summary-computation.py</a> is an optional step to prepare summary documents for inclusion in the <code class="docutils literal notranslate"><span class="pre">summaries</span></code> collection. Consider this option as an opportunity to pre-compute summary statistics and descriptions, lightening load and speeding up performance for users.</p></li>
<li><p><a class="reference external" href="https://github.com/argovis/tc-sync/blob/main/roundtrip.py">https://github.com/argovis/tc-sync/blob/main/roundtrip.py</a> is a proofreading script, intended to be run after collection population is complete, to double check that the data in MongoDB correctly matches upstream data products. Please note that <strong>it is not sufficient to run the same translation algorithm as originally populated the collections</strong>. The proofreading script should convert and compare between data formats using at least a slightly different procedure, to ensure that we get the same answer in two meaningfully different cases.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>At this point, you have enough information to update the docs at <a class="reference internal" href="getting_started.html#db-getting-started"><span class="std std-ref">Getting started with Argovis’ data</span></a> and <a class="reference internal" href="schema.html#schema"><span class="std std-ref">Argovis data schema</span></a>.</p>
<p><em>Last reviewed 24-04-11</em></p>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2024, Argovis Collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>